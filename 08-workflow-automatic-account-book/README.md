# AI Household Account Book: 자동 가계부


> **실시간 지출 데이터 전처리 및 분류 시스템**
> 
> 복잡한 결제 문자 메시지를 표준 JSON 포맷으로 변환하여 노션 데이터베이스에 즉시 동기화
>

- n8n 화면

사진 첨부

- 실제 결과물 화면

사진 첨부

## 📋 1. 목차


- 문제 정의
- 예상 사용자/부서
- 사용 방법
- 사용 비용
- 참고 문헌

## 🎯 2. 문제 정의


### **비효율적인 수동 입력과 재정 관리의 한계**

결제 발생 시마다 앱 푸시, SMS 등 다양한 채널에 산재된 내역을 일일이 확인하고, 이를 가계부나 스프레드시트에 수동으로 입력 및 분류하는 과정은 매우 비효율적이며 반복적인 노동입니다. 이러한 단순 반복 작업은 사용자에게 피로감을 주어 다음과 같은 문제들을 야기하며, 결과적으로 체계적인 자산 관리를 저해하는 주된 원인이 됩니다.

- **기록의 중단 (지속성 결여):** 번거로운 입력 과정에 지친 사용자가 가계부 작성을 중도에 포기하게 만들어, 지출 데이터의 연속성이 끊기고 기록이 누락됩니다.
- **인사이트 부재:** 단순 데이터 입력에 시간을 뺏겨, 정작 중요한 개인의 소비 패턴을 분석하거나 재정적 개선점을 도출하는 의미 있는 인사이트 확보에 실패합니다.

### **달성 가치**

반복적이고 소모적인 수동 입력 작업을 AI 기반 자동화로 완벽하게 대체함으로써, 사용자는 데이터 관리의 부담에서 벗어나 핵심적인 재정 계획 수립에 온전히 집중할 수 있습니다. 다양한 경로로 유입되는 **비정형 결제 텍스트를 실시간으로 수집 및 분석하여, 정확한 결제 정보(가맹점, 금액, 날짜)와 최적화된 소비 카테고리로 자동 구조화**합니다. 이를 통해 노션(Notion) 등의 데이터베이스에 오류 없는 데이터를 즉시 적재하여, 사용자가 언제든 정확한 지출 현황을 파악하고 데이터 기반의 재정 관리를 실현하도록 돕습니다.

## 📌 3. 예상 사용자/부서


> 본 워크플로우는 개인의 꼼꼼한 지출 관리부터 번거로운 법인 경비 처리까지, 스마트한 소비 기록이 필요한 모든 분을 위해 설계되었습니다.
> 
- **실시간 소비 트래킹이 필요한 사용자:** 결제 즉시 지출 흐름을 파악하여 계획적인 소비 습관을 형성하고자 하는 분
- **경비 처리가 번거로운 직장인:** 식대나 비품 등 법인 카드 사용 내역을 자동으로 분류하고 기록하여 업무 효율을 높이고 싶은 분
- **기록의 자동화를 원하는 모든 이:** 반복적인 수동 입력의 피로감에서 벗어나, 데이터 누락 없는 정확한 가계부를 유지하고 싶은 분

## 💬 4. 사용 방법


<details>
  <summary>필요한 API 연결</summary>
  <ul>
    <li>Google Sheets API 발급 및 Credential 연결</li>
    <li>Gemini API 발급 및 Credential 연결</li>
    <li>Notion API 발급 및 Credential 연결</li>
</details>


<details>
  <summary>워크플로우 상세 과정</summary>
  <ul>
    <li><strong>Webhook (Trigger)</strong>: MacroDroid에서 전송한 결제 문자 및 앱 푸시 알림 데이터를 실시간으로 수신하는 HTTP 엔드포인트</li>
    <li><strong>Google Sheets (Raw Data Logging)</strong>: 수신된 비정형 원본 텍스트(Raw Data)를 구글 시트에 즉시 적재하여 데이터 유실 방지 및 로그 확보</li>
    <li><strong>Edit Fields (Preprocessing)</strong>: 전체 웹훅 페이로드 중 분석에 필요한 핵심 텍스트 필드(body)만 추출하여 AI 입력 데이터로 가공하는 전처리 단계</li>
    <li><strong>AI Agent (LLM Analysis)</strong>: Google Gemini 모델을 활용해 비정형 텍스트를 파싱(Parsing)하고, 문맥 기반으로 소비 카테고리를 자동 분류하여 구조화</li>
    <li><strong>Code in JavaScript (Data Sanitization)</strong>: AI 응답 데이터에 포함된 마크다운 기호(```json) 등 불필요한 노이즈를 제거하고 순수 JSON 객체로 변환하는 후처리</li>
    <li><strong>Notion (Final Storage)</strong>: 최종 정제된 결제 데이터(날짜, 금액, 가맹점, 카테고리 등)를 노션 데이터베이스 스키마에 맞춰 매핑 및 저장</li>
  </ul>
</details>


<details>
  <summary>안드로이드 자동화 앱 설정: MacroDroid 앱 사용 (무료)</summary>
  **공통 사항**:

1. Play 스토어에서 `MacroDroid` 앱을 설치하고, '접근성', '알림 접근' 등 초기 권한을 모두 허용합니다.
2. `MacroDroid` 메인 화면에서 '매크로 추가'를 선택합니다.
  <ul>
      <details>
        <summary><strong>앱 푸시 알람</strong></summary>
        <br>

1. **트리거 (Triggers / 빨간색)** 섹션의 '+' 버튼을 누릅니다.
    - `기기 관련 변동` > `알림` > `알림을 받으면` > 확인
    - `앱 선택` > `알림을 보낼 앱` (광고 알림이 아닌 '결제' 알림을 보내는 앱을 선택)
    - `별도의 제목 및 텍스트 필터 사용` 체크
    - `제목` > `포함하면` > 결제`*` (카드사 알림 중 "결제" 단어가 포함된 알림만 감지하기 위함)
    - `메시지 내용` > `조건없음` > 확인
2. **액션 (Actions / 파란색)** 섹션의 '+' 버튼을 누릅니다.
    - `웹 접속` > `HTTP 요청`
    - `요청 종류`: `POST`
    - `URL 입력`: n8n `Webhook` 노드에서 복사한 **URL 붙여넣기**
    - `Body 내용` > `컨텐츠 타입` > `text/plain`
    - `Body 내용 (텍스트)`:
        
        ```
        {
          "text": "{notification}",
          "sender": "{not_title}",
          "time": "{system_time}"
        }
        ```
        
        (여기서 `[Body 내용]`은 MacroDroid의 '매직 텍스트' 버튼(…)을 눌러 `Body 내용` 변수를 선택합니다.)
        
3. 우측 하단의 '저장' 버튼을 누르고 매크로 이름을 (예: `가계부 전송`) 지정합니다.

  </details>
      <details>
        <summary><strong>AI Agent2: 회의 내용 파악 및 요약</strong></summary>
        <br>
