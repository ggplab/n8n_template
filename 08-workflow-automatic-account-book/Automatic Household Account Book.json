{
  "name": "Automatic Household Account Book",
  "nodes": [
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "google-sheet-doc-id-removed",
          "mode": "list",
          "cachedResultName": "ìë™ ê°€ê³„ë¶€",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/google-sheet-doc-id-removed/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "google-sheet-gid-removed",
          "mode": "list",
          "cachedResultName": "SMS_Log",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/google-sheet-doc-id-removed/edit#gid=google-sheet-gid-removed"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [],
          "schema": [
            {
              "id": "headers",
              "displayName": "headers",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "params",
              "displayName": "params",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "query",
              "displayName": "query",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "body",
              "displayName": "body",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "webhookUrl",
              "displayName": "webhookUrl",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "executionMode",
              "displayName": "executionMode",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        0,
        0
      ],
      "id": "4f5e1a7f-2a4c-4439-9834-d511db970ee1",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "credential-id-removed",
          "name": "Credential Name Removed"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b2a1b816-c8cc-4bf4-8c87-114945fc3a27",
              "name": "body",
              "value": "={{ $json.body }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        0
      ],
      "id": "b2e6f64f-dd08-43bd-a8cf-511238055a8d",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "budget",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -224,
        0
      ],
      "id": "dbb3f5c3-8fdf-4fd2-a710-c0c99aa9d1a1",
      "name": "Webhook1",
      "webhookId": "webhook-id-removed"
    },
    {
      "parameters": {
        "content": "## AI Agent with Gemini\nLLM(ê±°ëŒ€ì–¸ì–´ëª¨ë¸)ì„ í™œìš©í•œ ë¹„ì •í˜• ê²°ì œ ë°ì´í„°ì˜ íŒŒì‹±(Parsing) ë° ì¹´í…Œê³ ë¦¬ ìë™ ë¶„ë¥˜ ëª¨ë¸ë§\n\nì¶”ì¶œ ë°ì´í„°: ê°€ë§¹ì  ì´ë¦„, ê²°ì œ ë‚ ì§œ, ê²°ì œ ê¸ˆì•¡, ì¹´ë“œì‚¬ ì´ë¦„, ì§€ì¶œ ì¹´í…Œê³ ë¦¬",
        "height": 528,
        "width": 336,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        400,
        -176
      ],
      "typeVersion": 1,
      "id": "61a0d781-fe69-477d-92ea-f1430c3a4853",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "notion-database-id-removed",
          "mode": "list",
          "cachedResultName": "ê°€ê³„ë¶€",
          "cachedResultUrl": "https://www.notion.so/notion-database-id-removed"
        },
        "title": "={{ $json.merchant }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "date|date",
              "includeTime": false,
              "date": "={{ $json.date }}",
              "timezone": "Asia/Seoul"
            },
            {
              "key": "amount|number",
              "numberValue": "={{ $json.amount }}"
            },
            {
              "key": "card_company|multi_select",
              "multiSelectValue": "={{ $json.card_company }}"
            },
            {
              "key": "category|select",
              "selectValue": "={{ $json.category }}"
            }
          ]
        },
        "options": {
          "icon": "ğŸ’µ"
        }
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1040,
        0
      ],
      "id": "af85e7ac-a823-4037-bbac-a8173c6cc5a5",
      "name": "Create a database page",
      "credentials": {
        "notionApi": {
          "id": "credential-id-removed",
          "name": "Credential Name Removed"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        528,
        224
      ],
      "id": "2fe246cf-4c29-4d27-a58e-aeb32e56445e",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "credential-id-removed",
          "name": "Credential Name Removed"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. AIê°€ ì¤€ ë°ì´í„°(output) ê°€ì ¸ì˜¤ê¸°\nconst aiText = $input.first().json.output;\n\n// 2. ```json ê°™ì€ ë§ˆí¬ë‹¤ìš´ ê¸°í˜¸ ë‹¤ ì§€ìš°ê³ , { ì™€ } ì‚¬ì´ì˜ ë‚´ìš©ë§Œ ë°œë¼ë‚´ê¸°\nconst jsonStart = aiText.indexOf('{');\nconst jsonEnd = aiText.lastIndexOf('}') + 1;\nconst cleanJson = aiText.substring(jsonStart, jsonEnd);\n\n// 3. ì§„ì§œ JSON ë°ì´í„°ë¡œ ë³€í™˜í•´ì„œ ë‚´ë³´ë‚´ê¸°\nreturn JSON.parse(cleanJson);"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        816,
        0
      ],
      "id": "237ea9d9-e4ea-40b0-a058-ddc81ae8c866",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "content": "## Webhook\n**ê²°ì œ/ìŠ¹ì¸**ë¬¸ì ë˜ëŠ” ì•± ì•ŒëŒ ê°€ì ¸ì˜¤ê¸° ",
        "height": 240,
        "width": 192,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -272,
        -96
      ],
      "typeVersion": 1,
      "id": "615cb33f-e613-4ea2-9619-d54fb85e87a6",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Google Sheets\në¬¸ì/ì•ŒëŒ í…ìŠ¤íŠ¸ ê¸°ë¡",
        "height": 240,
        "width": 192
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -48,
        -96
      ],
      "typeVersion": 1,
      "id": "1ccc88d5-7874-422f-b1d6-25a6c9d9f19f",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## ë°ì´í„° ì „ì²˜ë¦¬\nì£¼ìš” ì»¬ëŸ¼ë§Œ ì¶”ì¶œ",
        "height": 240,
        "width": 192,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        176,
        -96
      ],
      "typeVersion": 1,
      "id": "41cbd3d7-1d31-4f98-85c7-dc0af2f82d8b",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body }}",
        "options": {
          "systemMessage": "=# Role\në‹¹ì‹ ì€ ê¸ˆìœµ ê²°ì œ ì•Œë¦¼ í…ìŠ¤íŠ¸ë¥¼ ë¶„ì„í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•  JSON ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” ì „ë¬¸ AI ë¹„ì„œì…ë‹ˆë‹¤.\n\n# Task\ní…ìŠ¤íŠ¸ë¥¼ ë¶„ì„í•˜ì—¬ ì•„ë˜ 5ê°€ì§€ í•„ë“œë¥¼ ì¶”ì¶œí•˜ê³ , ë°˜ë“œì‹œ ì§€ì •ëœ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì¶œë ¥í•˜ì‹­ì‹œì˜¤. (ë¶€ì—° ì„¤ëª… ê¸ˆì§€)\n\n# Output JSON Format\n{\n    \"merchant\": \"String\",      // ê°€ë§¹ì  ì´ë¦„ (íŠ¹ìˆ˜ë¬¸ì ì œê±°)\n    \"date\": \"YYYY-MM-DD\",      // ê²°ì œ ë‚ ì§œ\n    \"amount\": Integer,         // ê²°ì œ ê¸ˆì•¡ (ìˆ«ìë§Œ)\n    \"card_company\": \"String\",  // ì¹´ë“œì‚¬ ì´ë¦„\n    \"category\": \"String\"       // ì§€ì¶œ ì¹´í…Œê³ ë¦¬\n}\n\n# Parsing Rules (ì¤‘ìš”)\n1. **merchant (ì‚¬ìš©ì²˜)**: \n   - í…ìŠ¤íŠ¸ì—ì„œ ê°€ë§¹ì  ì´ë¦„ì„ ì°¾ìœ¼ì„¸ìš”. (ì˜ˆ: \"ì¹´í˜ì•„ì´ì— í‹° ì§€íƒ€ì›Œ*\")\n   - ì´ë¦„ ë’¤ì— ë¶™ì€ íŠ¹ìˆ˜ë¬¸ì(*, #)ë‚˜ ë¶ˆí•„ìš”í•œ ì§€ì ëª…, ë²•ì¸ í‘œê¸°((ì£¼))ëŠ” ìƒí™©ì— ë§ì¶° ê¹”ë”í•˜ê²Œ ì •ë¦¬í•˜ì„¸ìš”.\n   - ì˜ˆ: \"ì¹´í˜ì•„ì´ì— í‹° ì§€íƒ€ì›Œ*\" -> \"ì¹´í˜ì•„ì´ì— í‹°\"\n\n2. **amount (ê¸ˆì•¡)**:\n   - 'ë‚´ìš©'ë¿ë§Œ ì•„ë‹ˆë¼ **'ì œëª©'**ì— ì íŒ ê¸ˆì•¡ë„ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”. (íŠ¹íˆ í† ìŠ¤, ì¹´ì¹´ì˜¤í˜ì´ ë“±ì€ ì œëª©ì— ê¸ˆì•¡ì´ ìˆìŠµë‹ˆë‹¤.)\n   - \"3,200ì›\" -> 3200 (ì‰¼í‘œì™€ 'ì›' ì œê±°, ì •ìˆ˜í˜• ë°˜í™˜)\n   - 'ì·¨ì†Œ' ë¬¸ìê°€ í¬í•¨ëœ ê²½ìš° ìŒìˆ˜(-)ë¡œ í‘œê¸°í•˜ì„¸ìš”.\n\n3. **date (ë‚ ì§œ)**:\n   - í…ìŠ¤íŠ¸ì— ìˆëŠ” ë‚ ì§œ(ì˜ˆ: 10/29)ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.\n   - ì—°ë„ê°€ ì—†ë‹¤ë©´ í˜„ì¬ ì—°ë„ì¸ **2025ë…„**ì„ ë¶™ì—¬ì„œ \"2025-10-29\" í˜•ì‹ìœ¼ë¡œ ë§Œë“œì„¸ìš”.\n   - (ì°¸ê³ : ì…ë ¥ëœ 'ì‹œê°„' íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” ë¬´ì‹œí•˜ê³  í…ìŠ¤íŠ¸ ë‚ ì§œë¥¼ ë”°ë¥´ì„¸ìš”.)\n\n4. **card_company (ì¹´ë“œì‚¬)**:\n   - \"ìš°ë¦¬(3743)\" -> \"ìš°ë¦¬ì¹´ë“œ\" (ìˆ«ìë‚˜ ê´„í˜¸ ì œê±°)\n\n5. **category (ì¹´í…Œê³ ë¦¬)**:\n   - merchant(ì‚¬ìš©ì²˜)ì™€ ë¬¸ë§¥ì„ ë¶„ì„í•˜ì—¬ ì•„ë˜ ê¸°ì¤€ì— ë”°ë¼ ê°€ì¥ ì ì ˆí•œ ì¹´í…Œê³ ë¦¬ë¥¼ í•˜ë‚˜ë§Œ ì„ íƒí•˜ì„¸ìš”.\n\n   - **[ì‹ë¹„]**: ì¼ë°˜ ìŒì‹ì , ë°°ë‹¬ ì•±(ë°°ë‹¬ì˜ë¯¼ì¡±, ìš”ê¸°ìš”, ì¿ íŒ¡ì´ì¸ ), ì‹ì¬ë£Œ ì¥ë³´ê¸°(ì´ë§ˆíŠ¸, í™ˆí”ŒëŸ¬ìŠ¤, ë§ˆì¼“ì»¬ë¦¬, ë¡¯ë°ë§ˆíŠ¸), ë°˜ì°¬ê°€ê²Œ, ì£¼ì /ìˆ ì§‘\n   - **[ì¹´í˜]**: ì»¤í”¼ ì „ë¬¸ì (ìŠ¤íƒ€ë²…ìŠ¤, ë©”ê°€ì»¤í”¼, ì´ë””ì•¼ ë“±), ë² ì´ì»¤ë¦¬(íŒŒë¦¬ë°”ê²Œëœ¨, ëšœë ˆì¥¬ë¥´), ë””ì €íŠ¸ ê°€ê²Œ, ì•„ì´ìŠ¤í¬ë¦¼\n   - **[êµí†µ]**: íƒì‹œ(ì¹´ì¹´ì˜¤T, ìš°í‹°), ëŒ€ì¤‘êµí†µ(ì½”ë ˆì¼, í‹°ë¨¸ë‹ˆ), ì£¼ìœ ì†Œ, í•˜ì´íŒ¨ìŠ¤, ì£¼ì°¨ì¥, í‚¥ë³´ë“œ/ìì „ê±° ëŒ€ì—¬\n   - **[ì‡¼í•‘]**: ì˜¨ë¼ì¸ ì‡¼í•‘ëª°(ì¿ íŒ¡, ë„¤ì´ë²„ì‡¼í•‘, 11ë²ˆê°€), ë°±í™”ì , ì•„ìš¸ë ›, ë‹¤ì´ì†Œ, ì˜¬ë¦¬ë¸Œì˜, ì˜ë¥˜/ì¡í™” ë§¤ì¥, ê°€ì „ì œí’ˆ\n   - **[ì˜ë£Œ]**: ë³‘ì›, ì˜ì›, ì•½êµ­, í•œì˜ì›, ê±´ê°•ê²€ì§„ì„¼í„°, ë™ë¬¼ë³‘ì›\n   - **[ê³µê³¼ê¸ˆ]**: ì•„íŒŒíŠ¸ ê´€ë¦¬ë¹„, ì „ê¸°ìš”ê¸ˆ(í•œêµ­ì „ë ¥), ë„ì‹œê°€ìŠ¤, ìˆ˜ë„ì„¸, ì§€ë°©ì„¸/êµ­ì„¸, ê³¼íƒœë£Œ\n   - **[ë¬¸í™”]**: ì˜í™”ê´€(CGV, ë¡¯ë°ì‹œë„¤ë§ˆ), OTT êµ¬ë…(ë„·í”Œë¦­ìŠ¤, ìœ íŠœë¸Œ, ë©œë¡ ), ì„œì (êµë³´ë¬¸ê³ ), ì „ì‹œíšŒ/ê³µì—° ê´€ëŒ, PCë°©, ë…¸ë˜ë°©\n   - **[êµìœ¡]**: í•™ì›ë¹„, ì¸í„°ë„· ê°•ì˜(í´ë˜ìŠ¤101, ì¸í”„ëŸ°), ë…ì„œì‹¤/ìŠ¤í„°ë””ì¹´í˜, í•™ìŠµì§€\n   - **[í†µì‹ ]**: í†µì‹ ìš”ê¸ˆ(SKT, KT, LGU+), ì¸í„°ë„·/TV ìš”ê¸ˆ, ì•Œëœ°í° ìš”ê¸ˆ\n   - **[ê¸°íƒ€]**: ìœ„ ë¶„ë¥˜ì— ì†í•˜ì§€ ì•ŠëŠ” í•­ëª©, íšŒë¹„, ê²½ì¡°ì‚¬ë¹„, í˜„ê¸ˆì¸ì¶œ, ìˆ˜ìˆ˜ë£Œ, ê¸°ë¶€ê¸ˆ\n\n# Few-Shot Examples\nInput:\në‚´ìš©: [Webë°œì‹ ] ì‚¼ì„±(1234) ìŠ¹ì¸ í™ê¸¸ë™ 15,400ì› 11/24 12:30 (ì£¼)ë§¥ë„ë‚ ë“œê°•ë‚¨ì \në³´ë‚¸ê³³: 1588-8700\nì‹œê°„: 1763959619779\n\nOutput:\n{\n    \"merchant\": \"ë§¥ë„ë‚ ë“œ\",\n    \"date\": \"2025-11-24\",\n    \"amount\": 15400,\n    \"card_company\": \"ì‚¼ì„±ì¹´ë“œ\",\n    \"category\": \"ì‹ë¹„\"\n}\n\n# Output Rules (Strict)\n- **ì ˆëŒ€ë¡œ** ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡(```json ... ```)ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì‹­ì‹œì˜¤.\n- ì•ë’¤ì— ì„¤ëª…ì´ë‚˜ ê³µë°± ì—†ì´ **ì˜¤ì§ ìˆœìˆ˜ JSON í…ìŠ¤íŠ¸(Raw JSON)**ë§Œ ì¶œë ¥í•˜ì‹­ì‹œì˜¤."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        448,
        0
      ],
      "id": "c6d3ecf7-a9e9-4003-9a3d-86632a020132",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "content": "## ë°ì´í„° ì •ì œ\në§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡(```json) ë“±ì˜ ë¶ˆí•„ìš”í•œ ë¬¸ì ì œê±°",
        "height": 240,
        "width": 192,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        768,
        -96
      ],
      "typeVersion": 1,
      "id": "c26b1b77-f740-4b25-86c5-791bfd1857c3",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## Notion ê¸°ë¡\nNotion DBì— í˜•ì‹ì— ë§ê²Œ ë°ì´í„° ì…ë ¥",
        "height": 240,
        "width": 192
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        992,
        -96
      ],
      "typeVersion": 1,
      "id": "a5dcc685-61ba-4e2f-bc3a-f4264df53c1d",
      "name": "Sticky Note5"
    }
  ],
  "pinData": {},
  "connections": {
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook1": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Create a database page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "workflow-version-id-removed",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "instance-id-removed"
  },
  "id": "workflow-id-removed",
  "tags": []
}
